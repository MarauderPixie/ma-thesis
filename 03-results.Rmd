---
chapter: 3
knit: "bookdown::render_book"
---

```{r ch3-models-and-bayes-factors, cache=TRUE}
h1_null  <- readRDS("models/h1_transfer/h10.rds")
h1_block <- readRDS("models/h1_transfer/h11.rds")
h1_instr <- readRDS("models/h1_transfer/h12.rds")
h1_both  <- readRDS("models/h1_transfer/h131.rds")
h1_inter <- readRDS("models/h1_transfer/h132.rds")

# h2_null  <- readRDS("models/h2_training/h2_null.rds")
# h2_rules <- readRDS("models/h2_training/h2_rules.rds")
# h2_inter <- readRDS("models/h2_training/h2_inter.rds")

# bf_h11  <- bayes_factor(h1_blocked, h1_null)
# bf_h12  <- bayes_factor(h1_instructions, h1_null)
# bf_h131 <- bayes_factor(h1_both, h1_blocked)
# bf_h132 <- bayes_factor(h1_both, h1_instructions)
# bf_h133 <- bayes_factor(h1_both, h1_null)

# bf_h21  <- bayes_factor(h2_rules, h2_null)
# bf_h221 <- bayes_factor(h2_interaction, h2_rules)
# bf_h222 <- bayes_factor(h2_interaction, h2_null)
```

# Results {#ch:results}

## H1: Extrapolations in Transfer Phase

```{r h1_tbl_summary}
beobachtet <- extra_binom %>% 
  group_by(rules, blocked) %>% 
  summarise(
    mean_p = mean(p),
    sd_p   = sd(p),
    mean_k = mean(k),
    sd_k   = sd(k),
    mean_ckab6 = mean(exab6),
    mean_ckab5 = mean(exab5),
    .groups = "drop"
  )

beobachtet %>% 
    transmute(
        Group = case_when(
            rules == "no" & blocked == "no" ~ "No Treatment",
            rules == "yes" & blocked == "no" ~ "Rule Instructions",
            rules == "no" & blocked == "yes" ~ "Blocked Rules",
            rules == "yes" & blocked == "yes" ~ "Rule Instructions & Blocked Rules",
        ),
        "Mean % (SD)" = paste0(round(mean_p * 100, 2), " (", round(sd_p * 100, 2), ")"),
        "% Extrapolators"   = round(mean_ckab6 * 100)
    ) %>% 
  kbl(booktabs = TRUE, align = "l") %>%
  kable_styling(full_width = "FALSE")
```

```{r h1_plots_hist}
transfer %>% 
  filter(item == "transfer") %>% 
  group_by(subj_id, condition) %>% 
  summarise(ext = sum(extrapolation)) %>% 
  ggplot(aes(ext)) +
    facet_wrap(~condition) +
    geom_histogram(binwidth = 1) +
    scale_x_continuous(breaks = scales::pretty_breaks(n = 10), labels = c("", 0:9, "")) +
    labs(title = "Number of extrapolated stimuli per person and condition",
         x = "Extrapolations", y = "people")
```

The main interest of this study was to find out whether it is possible to increase the number of extrapolations and thereby the learning of a full XOR category structure via the use of rule instructions, the ordering of rules to learn and to look into a possible interaction of both. Table 2 shows the mean percentage of extrapolated stimuli per person by experimental condition as well as the percentage of extrapolators, that is people who extrapolated more than six of the nine critical stimuli. Figure 12 shows the number of extrapolations per person overall as well as between experimental groups. Fig x on the other hand shows decision gradients for all stimuli across the conditions.


```{r h1_plots_grad}
transfer %>% 
  count(condition, img_x, img_y, response) %>% 
  spread(response, n) %>% 
  mutate(
    # extra = ifelse(subj_id %in% extra_pols$subj_id, "Extrapolators", "Proximators"),
    Nobz = ifelse(is.na(Nobz), 0, Nobz),
    Grot = ifelse(is.na(Grot), 0, Grot),
    n = Nobz + Grot,
    p_Grot = (Grot / n * 100) |> round(2)
  ) %>% 
  ggplot(aes(img_x, img_y, fill = p_Grot)) +
    facet_wrap(~condition) +
    geom_tile(size = 1) +
    scale_fill_viridis_c() +
    theme_subjects +
    theme(legend.position = NULL)
```

### H1.1: Effect of blocked rules

In order to quantify evidence for or against an effect of rule structuring, we fitted an intercept-only model predicting the number of extrapolated stimuli per person and a model including a fixed effect of the blocked rule condition. 


## H2: Learning with Rule Instructions

A similar approach as under Section 1.1 was taken to investigate a possible advantageous effect of instructions mentioning rules on learning the category structure. 



## `report` output for `h1_inter`

```
Warnmeldungen:
1: Response residuals not available to calculate mean square error. (R)MSE is probably not reliable. 
2: Response residuals not available to calculate mean square error. (R)MSE is probably not reliable. 
```

We fitted a Bayesian logistic model (estimated using MCMC sampling with 4 chains of 12000 iterations and a warmup of 2000) to predict exab6 with blocked (formula: exab6 ~ blocked + rules + blocked:rules). Priors over parameters were all set as student_t (location = 0.00, scale = 1.00) distributions. The model's explanatory power is weak (R2 = 0.03, 95% CI [2.62e-04, 0.08]).  Within this model:

  - The effect of b Intercept (Median = -2.73, 95% CI [-3.84, -1.86]) has a 100.00% probability of being negative (< 0), 100.00% of being significant (< -0.09), and 100.00% of being large (< -0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18372)
  - The effect of b blockedyes (Median = 0.94, 95% CI [-0.10, 2.16]) has a 96.08% probability of being positive (> 0), 94.32% of being significant (> 0.09), and 76.47% of being large (> 0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 17127)
  - The effect of b rulesyes (Median = 0.58, 95% CI [-0.45, 1.75]) has a 86.39% probability of being positive (> 0), 82.13% of being significant (> 0.09), and 52.52% of being large (> 0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18220)
  - The interaction effect of rulesyes on b blockedyes (Median = -0.16, 95% CI [-1.50, 1.03]) has a 60.77% probability of being negative (< 0), 54.81% of being significant (< -0.09), and 27.44% of being large (< -0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18895)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.09| and |0.54|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017). and We fitted a Bayesian logistic model (estimated using MCMC sampling with 4 chains of 12000 iterations and a warmup of 2000) to predict exab6 with rules (formula: exab6 ~ blocked + rules + blocked:rules).
Priors over parameters were all set as student_t (location = 0.00, scale = 1.00) distributions. The model's explanatory power is weak (R2 = 0.03, 95% CI [2.62e-04, 0.08]).  Within this model:

  - The effect of b Intercept (Median = -2.73, 95% CI [-3.84, -1.86]) has a 100.00% probability of being negative (< 0), 100.00% of being significant (< -0.09), and 100.00% of being large (< -0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18372)
  - The effect of b blockedyes (Median = 0.94, 95% CI [-0.10, 2.16]) has a 96.08% probability of being positive (> 0), 94.32% of being significant (> 0.09), and 76.47% of being large (> 0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 17127)
  - The effect of b rulesyes (Median = 0.58, 95% CI [-0.45, 1.75]) has a 86.39% probability of being positive (> 0), 82.13% of being significant (> 0.09), and 52.52% of being large (> 0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18220)
  - The interaction effect of rulesyes on b blockedyes (Median = -0.16, 95% CI [-1.50, 1.03]) has a 60.77% probability of being negative (< 0), 54.81% of being significant (< -0.09), and 27.44% of being large (< -0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18895)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.09| and |0.54|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017).


## `report` output for `ck_inter_ab6`

```
Warnmeldungen:
1: Response residuals not available to calculate mean square error. (R)MSE is probably not reliable. 
2: Response residuals not available to calculate mean square error. (R)MSE is probably not reliable. 
```

We fitted a Bayesian logistic model (estimated using MCMC sampling with 4 chains of 12000 iterations and a warmup of 2000) to predict exab6 with blocked (formula: exab6 ~ blocked + rules + blocked:rules). Priors over parameters were all set as student_t (location = 0.00, scale = 1.00) distributions. The model's explanatory power is weak (R2 = 0.03, 95% CI [2.62e-04, 0.08]).  Within this model:

  - The effect of b Intercept (Median = -2.73, 95% CI [-3.84, -1.86]) has a 100.00% probability of being negative (< 0), 100.00% of being significant (< -0.09), and 100.00% of being large (< -0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18372)
  - The effect of b blockedyes (Median = 0.94, 95% CI [-0.10, 2.16]) has a 96.08% probability of being positive (> 0), 94.32% of being significant (> 0.09), and 76.47% of being large (> 0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 17127)
  - The effect of b rulesyes (Median = 0.58, 95% CI [-0.45, 1.75]) has a 86.39% probability of being positive (> 0), 82.13% of being significant (> 0.09), and 52.52% of being large (> 0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18220)
  - The interaction effect of rulesyes on b blockedyes (Median = -0.16, 95% CI [-1.50, 1.03]) has a 60.77% probability of being negative (< 0), 54.81% of being significant (< -0.09), and 27.44% of being large (< -0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18895)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.09| and |0.54|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017). and We fitted a Bayesian logistic model (estimated using MCMC sampling with 4 chains of 12000 iterations and a warmup of 2000) to predict exab6 with rules (formula: exab6 ~ blocked + rules + blocked:rules). Priors over parameters were all set as student_t (location = 0.00, scale = 1.00) distributions. The model's explanatory power is weak (R2 = 0.03, 95% CI [2.62e-04, 0.08]).  Within this model:

  - The effect of b Intercept (Median = -2.73, 95% CI [-3.84, -1.86]) has a 100.00% probability of being negative (< 0), 100.00% of being significant (< -0.09), and 100.00% of being large (< -0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18372)
  - The effect of b blockedyes (Median = 0.94, 95% CI [-0.10, 2.16]) has a 96.08% probability of being positive (> 0), 94.32% of being significant (> 0.09), and 76.47% of being large (> 0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 17127)
  - The effect of b rulesyes (Median = 0.58, 95% CI [-0.45, 1.75]) has a 86.39% probability of being positive (> 0), 82.13% of being significant (> 0.09), and 52.52% of being large (> 0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18220)
  - The interaction effect of rulesyes on b blockedyes (Median = -0.16, 95% CI [-1.50, 1.03]) has a 60.77% probability of being negative (< 0), 54.81% of being significant (< -0.09), and 27.44% of being large (< -0.54). The estimation successfully converged (Rhat = 1.000) and the indices are reliable (ESS = 18895)

Following the Sequential Effect eXistence and sIgnificance Testing (SEXIT) framework, we report the median of the posterior distribution and its 95% CI (Highest Density Interval), along the probability of direction (pd), the probability of significance and the probability of being large. The thresholds beyond which the effect is considered as significant (i.e., non-negligible) and large are |0.09| and |0.54|. Convergence and stability of the Bayesian sampling has been assessed using R-hat, which should be below 1.01 (Vehtari et al., 2019), and Effective Sample Size (ESS), which should be greater than 1000 (Burkner, 2017).